(this["webpackJsonppiano-play-react"]=this["webpackJsonppiano-play-react"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports=n(23)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,i,r,o=n(0),s=n.n(o),c=n(10),l=n.n(c),u=(n(16),n(8)),d=n(1),h=n(2),p=n(4),m=n(3),v=n(6),f=n(5);n(17);!function(e){e[e.Play=0]="Play",e[e.Quiz=1]="Quiz"}(a||(a={})),function(e){e[e.Starting=0]="Starting",e[e.InProgress=1]="InProgress",e[e.Finished=2]="Finished",e[e.None=3]="None"}(i||(i={})),function(e){e[e.Correct=0]="Correct",e[e.Incorrect=1]="Incorrect",e[e.None=2]="None"}(r||(r={}));n(18);var y=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"panel"},s.a.createElement("div",{className:"header"},this.props.message),s.a.createElement("div",{className:"content"},s.a.createElement("div",{className:"row"},s.a.createElement("span",null,"A simple and fun way for beginners to learn music notation.")),s.a.createElement("div",{className:"row"},s.a.createElement("button",{className:"btn btn-primary ".concat(this.props.mode===a.Play?"selected":""),onClick:function(){return e.props.onModeSelected(a.Play)}},"Play"),s.a.createElement("button",{className:"btn btn-primary ".concat(this.props.mode===a.Quiz?"selected":""),onClick:function(){return e.props.onModeSelected(a.Quiz)}},"Quiz"))))}}]),t}(s.a.Component),g=(n(19),function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.note?"Now playing":"Play";return s.a.createElement("div",null,s.a.createElement("div",{className:"header-secondary"},t),s.a.createElement("div",{className:"content"},!this.props.note&&s.a.createElement("div",null,s.a.createElement("div",{className:"row"},s.a.createElement("span",null,"Press a key on the ",s.a.createElement("b",null,"piano"),"\xa0",s.a.createElement("i",null,"below"),","),s.a.createElement("br",null),s.a.createElement("span",null,"and see the note appear on the"),s.a.createElement("br",null),s.a.createElement("span",null,s.a.createElement("b",null,"piano score")," to the ",s.a.createElement("i",null,"right.")))),this.props.note&&s.a.createElement("div",{className:"note-card",onClick:function(){return e.props.onNotePress(e.props.note)}},s.a.createElement("span",{className:"name"},this.props.note.fullname),s.a.createElement("span",{className:"octave"},"OCTAVE ",this.props.note.octave)),this.props.alternateNote&&s.a.createElement("div",{className:"note-card-or"},s.a.createElement("span",null," OR ")),this.props.alternateNote&&s.a.createElement("div",{className:"note-card",onClick:function(){return e.props.onNotePress(e.props.alternateNote)}},s.a.createElement("span",{className:"name"},this.props.alternateNote.fullname),s.a.createElement("span",{className:"octave"},"OCTAVE ",this.props.alternateNote.octave))))}}]),t}(s.a.Component)),b=(n(20),function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={level:"easy"},n.handleLevelChange=n.handleLevelChange.bind(Object(v.a)(n)),n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleLevelChange",value:function(e){this.setState({level:e.target.value})}},{key:"render",value:function(){var e=this,t="";return this.props.status===i.InProgress&&this.props.result&&(t=this.props.result.result===r.Correct?"\u2714 Correct, well done!":"\u2718 Incorrect"),s.a.createElement("div",null,s.a.createElement("div",{className:"header-secondary"},"Quiz"),s.a.createElement("div",{className:"content"},this.props.status===i.Starting&&s.a.createElement("div",null,s.a.createElement("div",{className:"row"},s.a.createElement("span",null,"Select level:"),s.a.createElement("select",{className:"dropdown",value:this.state.level,onChange:this.handleLevelChange},s.a.createElement("option",{value:"easy"},"Easy"),s.a.createElement("option",{value:"medium"},"Medium"),s.a.createElement("option",{value:"hard"},"Hard"))),s.a.createElement("div",{className:"row"},s.a.createElement("button",{id:"start-btn",className:"btn btn-secondary",onClick:function(){return e.props.onStartClick(e.state.level)}},"Start"))),this.props.status===i.InProgress&&s.a.createElement("div",null,s.a.createElement("div",{className:"row"},s.a.createElement("span",null,"Press the correct key on the piano.")),s.a.createElement("div",{className:"row"},s.a.createElement("span",{className:"score-label"},"Score"),s.a.createElement("span",{className:"score correct"},this.props.correct),s.a.createElement("span",{className:"score incorrect"},this.props.incorrect)),s.a.createElement("div",{className:"row"},s.a.createElement("span",null,t))),this.props.status===i.Finished&&s.a.createElement("div",null,s.a.createElement("div",{className:"row"},s.a.createElement("span",null,"Your score: "),s.a.createElement("span",null,s.a.createElement("b",null,this.props.correct)," out of ",this.props.total)),s.a.createElement("div",{className:"row"},s.a.createElement("span",null,this.props.description)),s.a.createElement("div",{className:"row"},s.a.createElement("button",{id:"tryagain-btn",className:"btn btn-secondary",onClick:function(){return e.props.onTryAgainClick()}},"Try Again?")))))}}]),t}(s.a.Component)),I=n(7),N=n.n(I),k=function(){function e(){Object(d.a)(this,e),this.maxNotes=16,this.vrvToolkit=void 0,this.spacingNotesXml=[],this.vrvToolkit=new verovio.toolkit;for(var t=0;t<this.maxNotes;t++)this.spacingNotesXml.push('<note xml:id="rest-hidden-'.concat(t.toString(),'" dur="4" oct="6" pname="c" stem.dir="up" />'))}return Object(h.a)(e,[{key:"renderNotation",value:function(e){for(var t=[],n=[],a=0;a<e.length;a++){var i='<note xml:id="'.concat(a,'" dur="4" oct="').concat(e[a].octave,'" pname="').concat(e[a].name,'" ').concat(e[a].accidental?'accid="'+e[a].accidental+'"':""," />"),r='<rest xml:id="rest-'.concat(a,'" dur="4" oct="').concat(e[a].octave,'" pname="').concat(e[a].name,'" ').concat(e[a].accidental?'accid="'+e[a].accidental+'"':"","/>");e[a].octave>3?(t.push(i),n.push(r)):(t.push(r),n.push(i))}var o='<?xml version="1.0" encoding="UTF-8"?>\n    <?xml-model href="http://music-encoding.org/schema/3.0.0/mei-all.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>\n    <?xml-model href="http://music-encoding.org/schema/3.0.0/mei-all.rng" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>\n    <mei xmlns="http://www.music-encoding.org/ns/mei" meiversion="3.0.0">\n      <music>\n          <body>\n                <mdiv>\n                  <score>\n                      <scoreDef>\n                            <staffGrp symbol="brace" label="">\n                              <staffDef clef.shape="G" clef.line="2" n="1" lines="5" />\n                              <staffDef clef.shape="F" clef.line="4" n="2" lines="5" />\n                            </staffGrp>\n                      </scoreDef>\n                      <section>\n                            <measure>\n                              <staff n="1">\n                                  <layer n="1" xml:id="layer-treple">\n                                        '.concat(t.join(""),'\n                                  </layer>\n                                  <layer xml:id="layer-spacing" n="2">\n                                        ').concat(this.spacingNotesXml.join(""),'\n                                  </layer>\n                              </staff>\n                              <staff n="2">\n                                  <layer xml:id="layer-bass" n="1">\n                                        ').concat(n.join(""),"\n                                  </layer>\n                              </staff>\n                            </measure>\n                      </section>\n                  </score>\n                </mdiv>\n          </body>\n      </music>\n    </mei>");return this.vrvToolkit.renderData(o,{pageWidth:1e3,border:25,scale:80,adjustPageHeight:1})}}]),e}(),w=(n(21),function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).notationService=void 0,n.state={notationAsSVG:null,notes:[]},n.notationService=new k,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;N()("g.note").off().on("click",(function(){e.noteClicked(this.id)}));for(var t=0;t<this.props.notes.length;t++)this.props.notes[t].color&&N()("#"+t).attr("fill",this.props.notes[t].color)}},{key:"noteClicked",value:function(e){console.log("noteClicked: "+e)}},{key:"render",value:function(){var e=this.notationService.renderNotation(this.props.notes);return s.a.createElement("div",{id:"notation",dangerouslySetInnerHTML:{__html:e}})}}]),t}(s.a.Component)),E=(n(22),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={},n.pianoKeys=[{whiteKeyId:16},{whiteKeyId:18,blackKeyId:17},{whiteKeyId:20,blackKeyId:19},{whiteKeyId:21},{whiteKeyId:23,blackKeyId:22},{whiteKeyId:25,blackKeyId:24},{whiteKeyId:27,blackKeyId:26},{whiteKeyId:28},{whiteKeyId:30,blackKeyId:29},{whiteKeyId:32,blackKeyId:31},{whiteKeyId:33},{whiteKeyId:35,blackKeyId:34},{whiteKeyId:37,blackKeyId:36},{whiteKeyId:39,blackKeyId:38},{whiteKeyId:40},{whiteKeyId:42,blackKeyId:41},{whiteKeyId:44,blackKeyId:43},{whiteKeyId:45},{whiteKeyId:47,blackKeyId:46},{whiteKeyId:49,blackKeyId:48},{whiteKeyId:51,blackKeyId:50},{whiteKeyId:52},{whiteKeyId:54,blackKeyId:53},{whiteKeyId:56,blackKeyId:55},{whiteKeyId:57},{whiteKeyId:59,blackKeyId:58},{whiteKeyId:61,blackKeyId:60},{whiteKeyId:63,blackKeyId:62},{whiteKeyId:64}],n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"getColor",value:function(e){return e===this.props.highlightedKeyId?"#f0e68c":""}},{key:"render",value:function(){var e=this,t=this.pianoKeys.map((function(t){return s.a.createElement("li",null,s.a.createElement("div",{className:"anchor",onClick:function(){return e.props.onKeyPress(t.whiteKeyId)}}),t.blackKeyId&&s.a.createElement("span",{onClick:function(){return e.props.onKeyPress(t.blackKeyId)}}))}));return s.a.createElement("div",{id:"p-wrapper"},s.a.createElement("ul",{id:"piano"},t))}}]),t}(s.a.Component)),S=function(){function e(){Object(d.a)(this,e),this.context=void 0,this.buffers={},this.initialize()}return Object(h.a)(e,[{key:"initialize",value:function(){console.log("initializing audio and loading sounds");try{"undefined"!==typeof AudioContext?this.context=new AudioContext:"undefined"!==typeof window.webkitAudioContext&&(this.context=new window.webkitAudioContext),this.loadSounds()}catch(e){alert("Web Audio API is not supported in this browser")}}},{key:"playNote",value:function(e){if((e<16||e>64)&&new RangeError("Invalid keyId. The valid range of keyId is 16 to 64."),this.buffers.hasOwnProperty(e)){console.log("SoundService: playing key="+e);var t=this.context.createBufferSource();t.buffer=this.buffers[e],t.connect(this.context.destination),t.start(0)}else console.log("Audio not loaded for key="+e)}},{key:"loadSounds",value:function(){for(var e=16;e<65;e++){var t="/piano-play-react"+"/sounds/".concat(e,".wav");this.loadBuffer(e.toString(),t)}}},{key:"loadBuffer",value:function(e,t){console.log("loadBuffer: name=".concat(e,", path=").concat(t));var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer";var a=this.context,i=this.buffers;n.onload=function(){a.decodeAudioData(n.response,(function(n){n?(console.log("audio loaded for: ",e),i[e]=n):alert("error decoding file data: "+t)}),(function(e){console.error("decodeAudioData error",e)}))},n.onerror=function(){alert("BufferLoader: XHR error")},n.send()}}]),e}(),z=function e(t,n){if(Object(d.a)(this,e),this.keyId=t,this.noteId=n,this.octave=void 0,this.name=void 0,this.accidental=void 0,this.fullname=void 0,this.color=void 0,this.sender=void 0,t<16||t>64)throw new RangeError("Invalid keyId. The valid range of keyId is 16 to 64.");if(n.length<2||n.length>3)throw new RangeError("noteId is invalid");this.name=n[0].toLowerCase(),this.octave=parseInt(n[1]),this.color="";var a="";3===n.length&&(this.accidental=n[2],"s"===this.accidental?a="\u266f":"f"===this.accidental&&(a="\u266d")),this.fullname=this.name.toUpperCase()+a},K=function(){function e(){var t=this;Object(d.a)(this,e),this.pianoKeyMap={},this.pianoNoteMap={},this.pianoKeyMap={16:["c2"],17:["c2s","d2f"],18:["d2"],19:["d2s","e2f"],20:["e2"],21:["f2"],22:["f2s","g2f"],23:["g2"],24:["g2s","a2f"],25:["a2"],26:["a2s","b2f"],27:["b2"],28:["c3"],29:["c3s","d3f"],30:["d3"],31:["d3s","e3f"],32:["e3"],33:["f3"],34:["f3s","g3f"],35:["g3"],36:["g3s","a3f"],37:["a3"],38:["a3s","b3f"],39:["b3"],40:["c4"],41:["c4s","d4f"],42:["d4"],43:["d4s","e4f"],44:["e4"],45:["f4"],46:["f4s","g4f"],47:["g4"],48:["g4s","a4f"],49:["a4"],50:["a4s","b4f"],51:["b4"],52:["c5"],53:["c5s","d5f"],54:["d5"],55:["d5s","e5f"],56:["e5"],57:["f5"],58:["f5s","g5f"],59:["g5"],60:["g5s","a5f"],61:["a5"],62:["a5s","b5f"],63:["b5"],64:["c6"]},Object.keys(this.pianoKeyMap).forEach((function(e){return t.pianoKeyMap[e].forEach((function(n){return t.pianoNoteMap[n]=e}))}))}return Object(h.a)(e,[{key:"getNote",value:function(e){if(this.pianoNoteMap.hasOwnProperty(e)){var t=parseInt(this.pianoNoteMap[e]);return new z(t,e)}throw new Error("Invalid noteId.")}},{key:"getNoteByKeyId",value:function(e){if(this.pianoKeyMap.hasOwnProperty(e)){var t=this.pianoKeyMap[e][0];return new z(e,t)}throw new Error("Invalid keyId. The valid range of keyId is 16 to 64.")}},{key:"getAlternateNote",value:function(e){if(!this.pianoNoteMap.hasOwnProperty(e))throw new Error("Invalid noteId");var t,n=parseInt(this.pianoNoteMap[e]),a=this.pianoKeyMap[n];return a.length>1&&(t=a[0]===e?new z(n,a[1]):new z(n,a[0])),t}},{key:"getAllNoteIds",value:function(){return Object.keys(this.pianoNoteMap)}},{key:"getAllNaturalNoteIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=[];return Object.keys(this.pianoNoteMap).forEach((function(a){if(2===a.length){var i=parseInt(a[1]);i>=e&&i<=t&&n.push(a)}})),n}}]),e}(),q=function e(t,n,a){Object(d.a)(this,e),this.actualNote=t,this.selectedKeyId=n,this.quizNumber=a,this.result=void 0,this.result=this.selectedKeyId===this.actualNote.keyId?r.Correct:r.Incorrect},C=function(){function e(){Object(d.a)(this,e),this.quizLength=16,this.quizNotes=[],this.quizResults=[],this.quizIndex=0,this.inProgress=!1,this.correct=0,this.incorrect=0,this.status=i.None}return Object(h.a)(e,[{key:"startQuiz",value:function(e,t){this.quizLength=e,this.quizNotes.length=0,this.quizResults.length=0,this.inProgress=!0,this.quizIndex=0,this.correct=0,this.incorrect=0;for(var n=0;n<this.quizLength;n++)this.quizNotes.push(t[Math.floor(Math.random()*t.length)])}},{key:"getCurrentIndex",value:function(){return this.quizIndex}},{key:"getCurrentNoteId",value:function(){return this.quizNotes[this.quizIndex]}},{key:"next",value:function(){return this.quizIndex===this.quizLength-1?(this.inProgress=!1,!1):(this.quizIndex++,!0)}},{key:"recordResult",value:function(e,t){var n=new q(t,e,this.quizIndex+1);return n.result===r.Correct?this.correct++:this.incorrect++,this.quizResults.push(n),n}}]),e}(),O=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).soundService=void 0,n.pianoService=void 0,n.quizService=void 0,n.maxNotes=16,n.state={mode:a.Play,notes:[],quizCorrect:0,quizIncorrect:0,quizLength:n.maxNotes,quizStatus:i.None,resultDescription:""},n.handleModeChange=n.handleModeChange.bind(Object(v.a)(n)),n.handleKeyPress=n.handleKeyPress.bind(Object(v.a)(n)),n.handleNotePress=n.handleNotePress.bind(Object(v.a)(n)),n.onStartClick=n.onStartClick.bind(Object(v.a)(n)),n.onTryAgainClick=n.onTryAgainClick.bind(Object(v.a)(n)),n.soundService=new S,n.pianoService=new K,n.quizService=new C,n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleModeChange",value:function(e){this.setState({mode:e,notes:[],alternateNote:void 0}),e===a.Quiz&&this.setState({quizCorrect:0,quizIncorrect:0,quizLength:this.maxNotes,quizStatus:i.Starting})}},{key:"addNote",value:function(e){var t=Object(u.a)(this.state.notes);t.length===this.maxNotes&&(t.length=0),t.push(e),this.setState({notes:t})}},{key:"updateNote",value:function(e,t){var n=Object(u.a)(this.state.notes);n[e]=t,this.setState({notes:n})}},{key:"handleKeyPress",value:function(e){var t=this;if(this.soundService.playNote(e),this.state.mode===a.Play){var n=this.pianoService.getNoteByKeyId(e),o=this.pianoService.getAlternateNote(n.noteId);this.addNote(n),this.setState({alternateNote:o})}else if(this.quizService.inProgress){var s=this.pianoService.getNote(this.quizService.getCurrentNoteId()),c=this.quizService.recordResult(e,s);c.result===r.Correct&&(s.color="#4CAF50"),c.result===r.Incorrect&&(s.color="#f44336"),this.updateNote(this.quizService.getCurrentIndex(),s),this.setState({quizCorrect:this.quizService.correct,quizIncorrect:this.quizService.incorrect,quizResult:c},(function(){if(t.quizService.next()){var e=t.pianoService.getNote(t.quizService.getCurrentNoteId());t.addNote(e)}else{var n="";n=t.quizService.correct===t.state.quizLength?"Perfect score, awesome!":t.quizService.correct>.8*t.state.quizLength?"Great score, well done!":t.quizService.correct>.6*t.state.quizLength?"Good score!":t.quizService.correct>.4*t.state.quizLength?"Not bad, keep trying.":"Looks like you need more practice.",t.setState({quizStatus:i.Finished,resultDescription:n})}}))}}},{key:"handleNotePress",value:function(e){var t=this.pianoService.getAlternateNote(e.noteId);this.addNote(e),this.setState({alternateNote:t}),this.soundService.playNote(e.keyId)}},{key:"onStartClick",value:function(e){var t=[];t="easy"===e?this.pianoService.getAllNaturalNoteIds(3,4):"medium"===e?this.pianoService.getAllNaturalNoteIds():this.pianoService.getAllNoteIds(),this.quizService.startQuiz(this.state.quizLength,t);var n=this.pianoService.getNote(this.quizService.getCurrentNoteId());this.setState({notes:[n],quizStatus:i.InProgress,quizCorrect:this.quizService.correct,quizIncorrect:this.quizService.incorrect})}},{key:"onTryAgainClick",value:function(){this.setState({notes:[],quizCorrect:0,quizIncorrect:0,quizLength:16,quizStatus:i.Starting})}},{key:"render",value:function(){return s.a.createElement("div",{id:"container"},s.a.createElement("div",{id:"side-content"},s.a.createElement(y,{message:"Piano Play",mode:this.state.mode,onModeSelected:this.handleModeChange}),s.a.createElement("div",{className:"panel"},this.state.mode===a.Play&&s.a.createElement(g,{note:this.state.notes[this.state.notes.length-1],alternateNote:this.state.alternateNote,onNotePress:this.handleNotePress}),this.state.mode===a.Quiz&&s.a.createElement(b,{status:this.state.quizStatus,correct:this.state.quizCorrect,incorrect:this.state.quizIncorrect,total:this.state.quizLength,description:this.state.resultDescription,result:this.state.quizResult,onStartClick:this.onStartClick,onTryAgainClick:this.onTryAgainClick}))),s.a.createElement("div",{id:"notation-component"},s.a.createElement(w,{notes:this.state.notes})),s.a.createElement("div",{id:"keyboard-component"},s.a.createElement(E,{highlightedKeyId:0,onKeyPress:this.handleKeyPress})),s.a.createElement("p",{id:"appDetails"},"Built with ",s.a.createElement("a",{href:"https://reactjs.org/"},"React")," (v16.12.0) - Source available on ",s.a.createElement("a",{href:"https://github.com/deanmalone/piano-play-react/"},"GitHub")))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[11,1,2]]]);
//# sourceMappingURL=main.ac8a842f.chunk.js.map